!function(e){var s=function(s,t){this.folderGroup=e(s),this.defaults={animation:"linear",animationDuration:400,openFirstFolder:!0,singleOpen:!0,onFocus:e.noop,beforeOpen:e.noop,afterOpen:e.noop,beforeClose:e.noop,afterClose:e.noop,onBlur:e.noop,labels:{ariaOpen:"Cliquer pour ouvrir",ariaClose:"Cliquer pour fermer"},classes:{ariaText:"aria-text",forceOpen:"is-default-open",folder:"folder",folderGroup:"folder-group",folderTrigger:"folder-trigger",folderContent:"folder-content",states:{active:"is-active"}}},this.classes=e.extend(!0,this.defaults.classes,window.project?window.project.classes:{}),this.labels=e.extend(!0,this.defaults.labels,window.project?window.project.labels:{}),this.config=e.extend(!0,this.defaults,t||{}),this.folders=this.folderGroup.find("."+this.classes.folder),this.folderGroup.find("."+this.classes.folderTrigger).buttonize({a11y:this.config.a11y}),this.folderGroup.find("."+this.classes.folderTrigger).attr("type","button"),this.folderTriggers=this.folderGroup.find("."+this.classes.folderTrigger),this.folderContents=this.folderGroup.find("."+this.classes.folderContent),this.folderTriggers.append('<span aria-live="polite" class="'+this.classes.ariaText+' visuallyhidden">'+this.labels.ariaOpen+"</span>"),this.folderArias=this.folderTriggers.find("."+this.classes.ariaText),this.init()};e.extend(s.prototype,{init:function(){this.bindEvents(),this.folders.each(e.proxy(function(s,t){var r=e(t);currentAriaContainer=r.find("."+this.classes.ariaText),currentContent=r.find("."+this.classes.folderContent),r.hasClass(this.classes.forceOpen)?(r.addClass(this.classes.states.active),this.changeAriaText(currentAriaContainer,this.labels.ariaClose)):(currentContent.hide(),this.changeAriaText(currentAriaContainer,this.labels.ariaOpen))},this)),this.config.openFirstFolder&&this.openFirstFolder()},bindEvents:function(){this.folderTriggers.on("click",e.proxy(function(s){e(s.currentTarget).closest("."+this.classes.folder).hasClass(this.classes.states.active)?this.closeFolder(e(s.currentTarget)):this.openFolder(e(s.currentTarget))},this)),this.folderTriggers.on("focus",e.proxy(function(s){this.onTriggerFocus(e(s.currentTarget))},this)),this.folderTriggers.on("blur",e.proxy(function(s){this.onTriggerBlur(e(s.currentTarget))},this)),this.folderTriggers.on("focus",this.config.onFocus),this.folderTriggers.on("blur",this.config.onBlur)},openFolder:function(s){this.config.beforeOpen(),currentAriaContainer=s.find("."+this.classes.ariaText),currentFolder=s.closest("."+this.classes.folder),currentContent=currentFolder.find("."+this.classes.folderContent),this.folders.removeClass(this.classes.states.active),currentFolder.addClass(this.classes.states.active),"none"!==this.config.animation?(1==this.config.singleOpen&&(this.folderContents.slideUp(this.config.animationDuration),this.changeAriaText(this.folderArias,this.labels.ariaOpen)),currentContent.slideDown(this.config.animationDuration,e.proxy(function(){this.config.afterOpen()},this))):(1==this.config.singleOpen&&(this.folderContents.hide(),this.changeAriaText(this.folderArias,this.labels.ariaOpen)),currentContent.show(),this.config.afterOpen()),this.changeAriaText(currentAriaContainer,this.labels.ariaClose)},closeFolder:function(s){this.config.beforeClose(),currentAriaContainer=s.find("."+this.classes.ariaText),currentFolder=s.closest("."+this.classes.folder),currentContent=currentFolder.find("."+this.classes.folderContent),currentFolder.removeClass(this.classes.states.active),"none"!==this.config.animation?currentContent.slideUp(this.config.animationDuration,e.proxy(function(){this.config.afterClose()},this)):(currentContent.hide(),this.config.afterClose()),this.changeAriaText(currentAriaContainer,this.labels.ariaOpen)},openFirstFolder:function(){var e=this.folders.first();e.find("."+this.classes.folderContent).show(),e.addClass(this.classes.states.active),this.changeAriaText(e.find("."+this.classes.ariaText),this.labels.ariaClose)},closeAll:function(){for(var s=this,t=0;t<this.folders.length;t++){var r=e(this.folders[t]);currentTrigger=r.find("."+this.classes.folderTrigger),currentAriaContainer=currentTrigger.find("."+this.classes.ariaText),currentFolder=currentTrigger.closest("."+this.classes.folder),currentContent=currentFolder.find("."+this.classes.folderContent),currentFolder.removeClass(this.classes.states.active),currentContent.hide(),s.changeAriaText(currentAriaContainer,this.labels.ariaOpen)}},changeAriaText:function(e,s){e.text(s)},onTriggerFocus:function(e){e.find("."+this.classes.ariaText).attr("aria-live","polite")},onTriggerBlur:function(e){e.find("."+this.classes.ariaText).removeAttr("aria-live")}}),e.fn.folder=function(t){return this.each(function(){var r=e(this);if(!r.data("folder")){var i=new s(this,t);r.data("folder",i)}})}}(jQuery);